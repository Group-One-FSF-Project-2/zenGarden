<style>

    svg {
        background-color: #a1c9a1;
    }   
    
    .leaf {
        transition: all 0.5s;
        animation: sway 5s ease-in-out infinite;
    }

    .fruit {
        transition: all 0.5s;
    }

    .fruit:hover {
        fill: rgb(255, 174, 0);
        animation: grow 0.5s forwards;
        transform-origin: center;
        transform-box: fill-box;
    }

    @keyframes grow {
        0% {
            transform: scale(1);
        }
        100% {
            transform: scale(2);
        }
    }

    @keyframes sway {
        0% {
            transform: rotate(0deg);
        }
        50% {
            transform: rotate(2deg);
        }
        100% {
            transform: rotate(0deg);
        }
    
        
    }

</style>
    
<body>
    <button id="removeButton">Clear</button>
    <button id="addButton">Add</button>

    <h1>Click on the fruit to harvest</h1>
    <h2 id="counter">Counter: </h2>
    
    <!-- View window -->
    <svg id="svgContainer" width="100%" height="600px"></svg>
    
    <script>
        const svgNS = "http://www.w3.org/2000/svg";
        const container = document.getElementById("svgContainer");
        
        // Counter for fruits picked
        let fruitsPicked = 0;

        // growth: Number of branches
        // originX: X position
        // originY: Y position
        function tree(growth, originX, originY) {
            const plantPart = document.createElementNS(svgNS, "g");

            // Move the plantPart group to the origin position
            plantPart.setAttribute("transform", `translate(${originX}, ${originY})`);

            // Randomly determine the length and angle of the branch
            const length = 25 + Math.random() * 10;
            const angle = -60 + Math.random() * 120; // Allow angles only upwards

            // Calculate the end position of the branch
            const endX = originX + angle;
            const endY = originY - length

            // Create a tree branch that goes up at a random angle
            const line = document.createElementNS(svgNS, "line");
            // Start has already been set by the transform attribute of the plantPart group
            line.setAttribute("x1", 0);
            line.setAttribute("y1", 0);
            line.setAttribute("x2", endX - originX);
            line.setAttribute("y2", endY - originY);
            line.setAttribute("stroke", "brown");
            line.setAttribute("stroke-width", 1.5);
            plantPart.appendChild(line);

            // add a small green circle leaf at the end of the branch
            const circle = document.createElementNS(svgNS, "circle");
            circle.setAttribute("cx", endX - originX);  // Relative to the plantPart group
            circle.setAttribute("cy", endY - originY);  // Relative to the plantPart group
            
            // make random ones red
            if (Math.random() > 0.95) {
                circle.setAttribute("r", 10);
                circle.setAttribute("fill", "darkorange");
                circle.setAttribute("class", "fruit");
            } else {
                circle.setAttribute("r", 5);
                circle.setAttribute("fill", "green");
                circle.setAttribute("class", "leaf");
            }
            plantPart.appendChild(circle);

            container.appendChild(plantPart);

            if (growth > 0) {
                setTimeout(() => {
                    // Create 2 more branches at the end of the current branch
                    tree(growth - 1, endX, endY);
                    tree(growth - 1, endX, endY);
                }, 100); // Delay before creating the next branch
            }
        }
    
        // Clear Screen
        document.getElementById("removeButton").addEventListener("click", function() {
            const shapes = document.querySelectorAll("#svgContainer g");
            shapes.forEach(shape => shape.remove());
        });
    
        // Add shapes
        document.getElementById("addButton").addEventListener("click", function() {
            const originX = Math.random() * container.clientWidth;
            // Half the height + random height
            const originY = container.clientHeight / 2 + Math.random() * container.clientHeight / 2;
            tree(7, originX, originY);
        });

        // harvest fruit
        container.addEventListener("click", function(event) {
            if (event.target.classList.contains("fruit")) {
                event.target.remove();
                fruitsPicked++;
                document.getElementById("counter").textContent = `Counter: ${fruitsPicked}`;
            }
        });

    </script>
</body>